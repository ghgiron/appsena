{"ast":null,"code":"var _jsxFileName = \"D:\\\\proyectos_react\\\\Proyecto_sena\\\\src\\\\app\\\\fuse-layouts\\\\shared-components\\\\chatPanel\\\\Chat.js\";\nimport FuseScrollbars from '@fuse/core/FuseScrollbars';\nimport Avatar from '@material-ui/core/Avatar';\nimport Icon from '@material-ui/core/Icon';\nimport IconButton from '@material-ui/core/IconButton';\nimport Paper from '@material-ui/core/Paper';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport clsx from 'clsx';\nimport moment from 'moment/moment';\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { sendMessage } from './store/chatSlice';\nimport { selectContacts } from './store/contactsSlice';\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: theme.palette.background.default\n  },\n  messageRow: {\n    position: 'relative',\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'flex-start',\n    justifyContent: 'flex-end',\n    padding: '0 16px 4px 16px',\n    flex: '0 0 auto',\n    '&.contact': {\n      '& $bubble': {\n        backgroundColor: theme.palette.background.paper,\n        color: theme.palette.getContrastText(theme.palette.background.paper),\n        borderTopLeftRadius: 5,\n        borderBottomLeftRadius: 5,\n        borderTopRightRadius: 20,\n        borderBottomRightRadius: 20,\n        '& $time': {\n          marginLeft: 12\n        }\n      },\n      '&.first-of-group': {\n        '& $bubble': {\n          borderTopLeftRadius: 20\n        }\n      },\n      '&.last-of-group': {\n        '& $bubble': {\n          borderBottomLeftRadius: 20\n        }\n      }\n    },\n    '&.me': {\n      paddingLeft: 40,\n      '& $avatar': {\n        order: 2,\n        margin: '0 0 0 16px'\n      },\n      '& $bubble': {\n        marginLeft: 'auto',\n        backgroundColor: theme.palette.primary.main,\n        color: theme.palette.primary.contrastText,\n        borderTopLeftRadius: 20,\n        borderBottomLeftRadius: 20,\n        borderTopRightRadius: 5,\n        borderBottomRightRadius: 5,\n        '& $time': {\n          justifyContent: 'flex-end',\n          right: 0,\n          marginRight: 12\n        }\n      },\n      '&.first-of-group': {\n        '& $bubble': {\n          borderTopRightRadius: 20\n        }\n      },\n      '&.last-of-group': {\n        '& $bubble': {\n          borderBottomRightRadius: 20\n        }\n      }\n    },\n    '&.contact + .me, &.me + .contact': {\n      paddingTop: 20,\n      marginTop: 20\n    },\n    '&.first-of-group': {\n      '& $bubble': {\n        borderTopLeftRadius: 20,\n        paddingTop: 13\n      }\n    },\n    '&.last-of-group': {\n      '& $bubble': {\n        borderBottomLeftRadius: 20,\n        paddingBottom: 13,\n        '& $time': {\n          display: 'flex'\n        }\n      }\n    }\n  },\n  avatar: {\n    position: 'absolute',\n    left: -32,\n    margin: 0\n  },\n  bubble: {\n    position: 'relative',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 12,\n    maxWidth: '100%',\n    boxShadow: theme.shadows[1]\n  },\n  message: {\n    whiteSpace: 'pre-wrap',\n    lineHeight: 1.2\n  },\n  time: {\n    position: 'absolute',\n    display: 'none',\n    width: '100%',\n    fontSize: 11,\n    marginTop: 8,\n    top: '100%',\n    left: 0,\n    whiteSpace: 'nowrap'\n  },\n  bottom: {// background: theme.palette.background.default,\n    // borderTop: '1px solid rgba(0, 0, 0, 0.13)'\n  },\n  inputWrapper: {\n    borderRadius: 24\n  }\n}));\n\nfunction Chat(props) {\n  const dispatch = useDispatch();\n  const contacts = useSelector(selectContacts);\n  const selectedContactId = useSelector(({\n    chatPanel\n  }) => chatPanel.contacts.selectedContactId);\n  const chat = useSelector(({\n    chatPanel\n  }) => chatPanel.chat);\n  const user = useSelector(({\n    chatPanel\n  }) => chatPanel.user);\n  const classes = useStyles();\n  const chatScroll = useRef(null);\n  const [messageText, setMessageText] = useState('');\n  useEffect(() => {\n    scrollToBottom();\n  }, [chat]);\n\n  function scrollToBottom() {\n    chatScroll.current.scrollTop = chatScroll.current.scrollHeight;\n  }\n\n  const onInputChange = ev => {\n    setMessageText(ev.target.value);\n  };\n\n  const onMessageSubmit = ev => {\n    ev.preventDefault();\n\n    if (messageText === '') {\n      return;\n    }\n\n    dispatch(sendMessage({\n      messageText,\n      chatId: chat.id,\n      contactId: selectedContactId\n    })).then(() => {\n      setMessageText('');\n    }); // dispatch(sendMessage({ messageText, chatId: chat.id, contactId: user.id })).then(() => {\n    // \tsetMessageText('');\n    // });\n  };\n\n  return /*#__PURE__*/React.createElement(Paper, {\n    elevation: 3,\n    className: clsx(classes.root, 'flex flex-col relative pb-64', props.className),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 3\n    }\n  }, useMemo(() => {\n    const shouldShowContactAvatar = (item, i) => {\n      return item.who === selectedContactId && (chat.dialog[i + 1] && chat.dialog[i + 1].who !== selectedContactId || !chat.dialog[i + 1]);\n    };\n\n    const isFirstMessageOfGroup = (item, i) => {\n      return i === 0 || chat.dialog[i - 1] && chat.dialog[i - 1].who !== item.who;\n    };\n\n    const isLastMessageOfGroup = (item, i) => {\n      return i === chat.dialog.length - 1 || chat.dialog[i + 1] && chat.dialog[i + 1].who !== item.who;\n    };\n\n    return /*#__PURE__*/React.createElement(FuseScrollbars, {\n      ref: chatScroll,\n      className: \"flex flex-1 flex-col overflow-y-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 6\n      }\n    }, !chat ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex flex-col flex-1 items-center justify-center p-24\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 8\n      }\n    }, /*#__PURE__*/React.createElement(Icon, {\n      className: \"text-128\",\n      color: \"disabled\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }\n    }, \"chat\"), /*#__PURE__*/React.createElement(Typography, {\n      className: \"px-16 pb-24 mt-24 text-center\",\n      color: \"textSecondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }\n    }, \"Select a contact to start a conversation.\")) : chat.dialog.length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex flex-col pt-16 ltr:pl-40 rtl:pr-40 pb-40\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 8\n      }\n    }, chat.dialog.map((item, i) => {\n      const contact = item.who === user.id ? user : contacts.find(_contact => _contact.id === item.who);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: item.time,\n        className: clsx(classes.messageRow, {\n          me: item.who === user.id\n        }, {\n          contact: item.who !== user.id\n        }, {\n          'first-of-group': isFirstMessageOfGroup(item, i)\n        }, {\n          'last-of-group': isLastMessageOfGroup(item, i)\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 11\n        }\n      }, shouldShowContactAvatar(item, i) && /*#__PURE__*/React.createElement(Avatar, {\n        className: classes.avatar,\n        src: contact.avatar,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.bubble,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 12\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classes.message,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 13\n        }\n      }, item.message), /*#__PURE__*/React.createElement(Typography, {\n        className: classes.time,\n        color: \"textSecondary\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 13\n        }\n      }, moment(item.time).format('MMMM Do YYYY, h:mm:ss a'))));\n    })) : /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex flex-col flex-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 8\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"flex flex-col flex-1 items-center justify-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Icon, {\n      className: \"text-128\",\n      color: \"disabled\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 10\n      }\n    }, \"chat\")), /*#__PURE__*/React.createElement(Typography, {\n      className: \"px-16 pb-24 text-center\",\n      color: \"textSecondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }\n    }, \"Start a conversation by typing your message below.\")));\n  }, [chat, classes, contacts, selectedContactId, user]), chat && /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: onMessageSubmit,\n    className: clsx(classes.bottom, 'pb-16 px-8 absolute bottom-0 left-0 right-0'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    className: clsx(classes.inputWrapper, 'flex items-center relative'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    autoFocus: false,\n    id: \"message-input\",\n    className: \"flex-1\",\n    InputProps: {\n      disableUnderline: true,\n      classes: {\n        root: 'flex flex-grow flex-shrink-0 mx-16 ltr:mr-48 rtl:ml-48 my-8',\n        input: ''\n      },\n      placeholder: 'Type your message'\n    },\n    InputLabelProps: {\n      shrink: false,\n      className: classes.bootstrapFormLabel\n    },\n    onChange: onInputChange,\n    value: messageText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(IconButton, {\n    className: \"absolute ltr:right-0 rtl:left-0 top-0\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    className: \"text-24\",\n    color: \"action\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 8\n    }\n  }, \"send\")))));\n}\n\nexport default Chat;","map":{"version":3,"sources":["D:/proyectos_react/Proyecto_sena/src/app/fuse-layouts/shared-components/chatPanel/Chat.js"],"names":["FuseScrollbars","Avatar","Icon","IconButton","Paper","makeStyles","TextField","Typography","clsx","moment","React","useEffect","useMemo","useRef","useState","useDispatch","useSelector","sendMessage","selectContacts","useStyles","theme","root","background","palette","default","messageRow","position","display","flexDirection","alignItems","justifyContent","padding","flex","backgroundColor","paper","color","getContrastText","borderTopLeftRadius","borderBottomLeftRadius","borderTopRightRadius","borderBottomRightRadius","marginLeft","paddingLeft","order","margin","primary","main","contrastText","right","marginRight","paddingTop","marginTop","paddingBottom","avatar","left","bubble","maxWidth","boxShadow","shadows","message","whiteSpace","lineHeight","time","width","fontSize","top","bottom","inputWrapper","borderRadius","Chat","props","dispatch","contacts","selectedContactId","chatPanel","chat","user","classes","chatScroll","messageText","setMessageText","scrollToBottom","current","scrollTop","scrollHeight","onInputChange","ev","target","value","onMessageSubmit","preventDefault","chatId","id","contactId","then","className","shouldShowContactAvatar","item","i","who","dialog","isFirstMessageOfGroup","isLastMessageOfGroup","length","map","contact","find","_contact","me","format","disableUnderline","input","placeholder","shrink","bootstrapFormLabel"],"mappings":"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","sourcesContent":["import FuseScrollbars from '@fuse/core/FuseScrollbars';\nimport Avatar from '@material-ui/core/Avatar';\nimport Icon from '@material-ui/core/Icon';\nimport IconButton from '@material-ui/core/IconButton';\nimport Paper from '@material-ui/core/Paper';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport clsx from 'clsx';\nimport moment from 'moment/moment';\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { sendMessage } from './store/chatSlice';\nimport { selectContacts } from './store/contactsSlice';\n\nconst useStyles = makeStyles(theme => ({\n\troot: {\n\t\tbackground: theme.palette.background.default\n\t},\n\tmessageRow: {\n\t\tposition: 'relative',\n\t\tdisplay: 'flex',\n\t\tflexDirection: 'column',\n\t\talignItems: 'flex-start',\n\t\tjustifyContent: 'flex-end',\n\t\tpadding: '0 16px 4px 16px',\n\t\tflex: '0 0 auto',\n\t\t'&.contact': {\n\t\t\t'& $bubble': {\n\t\t\t\tbackgroundColor: theme.palette.background.paper,\n\t\t\t\tcolor: theme.palette.getContrastText(theme.palette.background.paper),\n\t\t\t\tborderTopLeftRadius: 5,\n\t\t\t\tborderBottomLeftRadius: 5,\n\t\t\t\tborderTopRightRadius: 20,\n\t\t\t\tborderBottomRightRadius: 20,\n\t\t\t\t'& $time': {\n\t\t\t\t\tmarginLeft: 12\n\t\t\t\t}\n\t\t\t},\n\t\t\t'&.first-of-group': {\n\t\t\t\t'& $bubble': {\n\t\t\t\t\tborderTopLeftRadius: 20\n\t\t\t\t}\n\t\t\t},\n\t\t\t'&.last-of-group': {\n\t\t\t\t'& $bubble': {\n\t\t\t\t\tborderBottomLeftRadius: 20\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t'&.me': {\n\t\t\tpaddingLeft: 40,\n\n\t\t\t'& $avatar': {\n\t\t\t\torder: 2,\n\t\t\t\tmargin: '0 0 0 16px'\n\t\t\t},\n\n\t\t\t'& $bubble': {\n\t\t\t\tmarginLeft: 'auto',\n\t\t\t\tbackgroundColor: theme.palette.primary.main,\n\t\t\t\tcolor: theme.palette.primary.contrastText,\n\t\t\t\tborderTopLeftRadius: 20,\n\t\t\t\tborderBottomLeftRadius: 20,\n\t\t\t\tborderTopRightRadius: 5,\n\t\t\t\tborderBottomRightRadius: 5,\n\t\t\t\t'& $time': {\n\t\t\t\t\tjustifyContent: 'flex-end',\n\t\t\t\t\tright: 0,\n\t\t\t\t\tmarginRight: 12\n\t\t\t\t}\n\t\t\t},\n\t\t\t'&.first-of-group': {\n\t\t\t\t'& $bubble': {\n\t\t\t\t\tborderTopRightRadius: 20\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'&.last-of-group': {\n\t\t\t\t'& $bubble': {\n\t\t\t\t\tborderBottomRightRadius: 20\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t'&.contact + .me, &.me + .contact': {\n\t\t\tpaddingTop: 20,\n\t\t\tmarginTop: 20\n\t\t},\n\t\t'&.first-of-group': {\n\t\t\t'& $bubble': {\n\t\t\t\tborderTopLeftRadius: 20,\n\t\t\t\tpaddingTop: 13\n\t\t\t}\n\t\t},\n\t\t'&.last-of-group': {\n\t\t\t'& $bubble': {\n\t\t\t\tborderBottomLeftRadius: 20,\n\t\t\t\tpaddingBottom: 13,\n\t\t\t\t'& $time': {\n\t\t\t\t\tdisplay: 'flex'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tavatar: {\n\t\tposition: 'absolute',\n\t\tleft: -32,\n\t\tmargin: 0\n\t},\n\tbubble: {\n\t\tposition: 'relative',\n\t\tdisplay: 'flex',\n\t\talignItems: 'center',\n\t\tjustifyContent: 'center',\n\t\tpadding: 12,\n\t\tmaxWidth: '100%',\n\t\tboxShadow: theme.shadows[1]\n\t},\n\tmessage: {\n\t\twhiteSpace: 'pre-wrap',\n\t\tlineHeight: 1.2\n\t},\n\ttime: {\n\t\tposition: 'absolute',\n\t\tdisplay: 'none',\n\t\twidth: '100%',\n\t\tfontSize: 11,\n\t\tmarginTop: 8,\n\t\ttop: '100%',\n\t\tleft: 0,\n\t\twhiteSpace: 'nowrap'\n\t},\n\tbottom: {\n\t\t// background: theme.palette.background.default,\n\t\t// borderTop: '1px solid rgba(0, 0, 0, 0.13)'\n\t},\n\tinputWrapper: {\n\t\tborderRadius: 24\n\t}\n}));\n\nfunction Chat(props) {\n\tconst dispatch = useDispatch();\n\tconst contacts = useSelector(selectContacts);\n\tconst selectedContactId = useSelector(({ chatPanel }) => chatPanel.contacts.selectedContactId);\n\tconst chat = useSelector(({ chatPanel }) => chatPanel.chat);\n\tconst user = useSelector(({ chatPanel }) => chatPanel.user);\n\n\tconst classes = useStyles();\n\tconst chatScroll = useRef(null);\n\tconst [messageText, setMessageText] = useState('');\n\n\tuseEffect(() => {\n\t\tscrollToBottom();\n\t}, [chat]);\n\n\tfunction scrollToBottom() {\n\t\tchatScroll.current.scrollTop = chatScroll.current.scrollHeight;\n\t}\n\n\tconst onInputChange = ev => {\n\t\tsetMessageText(ev.target.value);\n\t};\n\n\tconst onMessageSubmit = ev => {\n\t\tev.preventDefault();\n\t\tif (messageText === '') {\n\t\t\treturn;\n\t\t}\n\t\tdispatch(\n\t\t\tsendMessage({\n\t\t\t\tmessageText,\n\t\t\t\tchatId: chat.id,\n\t\t\t\tcontactId: selectedContactId\n\t\t\t})\n\t\t).then(() => {\n\t\t\tsetMessageText('');\n\t\t});\n\t\t// dispatch(sendMessage({ messageText, chatId: chat.id, contactId: user.id })).then(() => {\n\t\t// \tsetMessageText('');\n\t\t// });\n\t};\n\n\treturn (\n\t\t<Paper elevation={3} className={clsx(classes.root, 'flex flex-col relative pb-64', props.className)}>\n\t\t\t{useMemo(() => {\n\t\t\t\tconst shouldShowContactAvatar = (item, i) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\titem.who === selectedContactId &&\n\t\t\t\t\t\t((chat.dialog[i + 1] && chat.dialog[i + 1].who !== selectedContactId) || !chat.dialog[i + 1])\n\t\t\t\t\t);\n\t\t\t\t};\n\n\t\t\t\tconst isFirstMessageOfGroup = (item, i) => {\n\t\t\t\t\treturn i === 0 || (chat.dialog[i - 1] && chat.dialog[i - 1].who !== item.who);\n\t\t\t\t};\n\n\t\t\t\tconst isLastMessageOfGroup = (item, i) => {\n\t\t\t\t\treturn i === chat.dialog.length - 1 || (chat.dialog[i + 1] && chat.dialog[i + 1].who !== item.who);\n\t\t\t\t};\n\t\t\t\treturn (\n\t\t\t\t\t<FuseScrollbars ref={chatScroll} className=\"flex flex-1 flex-col overflow-y-auto\">\n\t\t\t\t\t\t{!chat ? (\n\t\t\t\t\t\t\t<div className=\"flex flex-col flex-1 items-center justify-center p-24\">\n\t\t\t\t\t\t\t\t<Icon className=\"text-128\" color=\"disabled\">\n\t\t\t\t\t\t\t\t\tchat\n\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t\t<Typography className=\"px-16 pb-24 mt-24 text-center\" color=\"textSecondary\">\n\t\t\t\t\t\t\t\t\tSelect a contact to start a conversation.\n\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : chat.dialog.length > 0 ? (\n\t\t\t\t\t\t\t<div className=\"flex flex-col pt-16 ltr:pl-40 rtl:pr-40 pb-40\">\n\t\t\t\t\t\t\t\t{chat.dialog.map((item, i) => {\n\t\t\t\t\t\t\t\t\tconst contact =\n\t\t\t\t\t\t\t\t\t\titem.who === user.id\n\t\t\t\t\t\t\t\t\t\t\t? user\n\t\t\t\t\t\t\t\t\t\t\t: contacts.find(_contact => _contact.id === item.who);\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={item.time}\n\t\t\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\t\t\tclasses.messageRow,\n\t\t\t\t\t\t\t\t\t\t\t\t{ me: item.who === user.id },\n\t\t\t\t\t\t\t\t\t\t\t\t{ contact: item.who !== user.id },\n\t\t\t\t\t\t\t\t\t\t\t\t{ 'first-of-group': isFirstMessageOfGroup(item, i) },\n\t\t\t\t\t\t\t\t\t\t\t\t{ 'last-of-group': isLastMessageOfGroup(item, i) }\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{shouldShowContactAvatar(item, i) && (\n\t\t\t\t\t\t\t\t\t\t\t\t<Avatar className={classes.avatar} src={contact.avatar} />\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t<div className={classes.bubble}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className={classes.message}>{item.message}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<Typography className={classes.time} color=\"textSecondary\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{moment(item.time).format('MMMM Do YYYY, h:mm:ss a')}\n\t\t\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div className=\"flex flex-col flex-1\">\n\t\t\t\t\t\t\t\t<div className=\"flex flex-col flex-1 items-center justify-center\">\n\t\t\t\t\t\t\t\t\t<Icon className=\"text-128\" color=\"disabled\">\n\t\t\t\t\t\t\t\t\t\tchat\n\t\t\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Typography className=\"px-16 pb-24 text-center\" color=\"textSecondary\">\n\t\t\t\t\t\t\t\t\tStart a conversation by typing your message below.\n\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</FuseScrollbars>\n\t\t\t\t);\n\t\t\t}, [chat, classes, contacts, selectedContactId, user])}\n\t\t\t{chat && (\n\t\t\t\t<form\n\t\t\t\t\tonSubmit={onMessageSubmit}\n\t\t\t\t\tclassName={clsx(classes.bottom, 'pb-16 px-8 absolute bottom-0 left-0 right-0')}\n\t\t\t\t>\n\t\t\t\t\t<Paper className={clsx(classes.inputWrapper, 'flex items-center relative')}>\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tautoFocus={false}\n\t\t\t\t\t\t\tid=\"message-input\"\n\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\tdisableUnderline: true,\n\t\t\t\t\t\t\t\tclasses: {\n\t\t\t\t\t\t\t\t\troot: 'flex flex-grow flex-shrink-0 mx-16 ltr:mr-48 rtl:ml-48 my-8',\n\t\t\t\t\t\t\t\t\tinput: ''\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tplaceholder: 'Type your message'\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tInputLabelProps={{\n\t\t\t\t\t\t\t\tshrink: false,\n\t\t\t\t\t\t\t\tclassName: classes.bootstrapFormLabel\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonChange={onInputChange}\n\t\t\t\t\t\t\tvalue={messageText}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<IconButton className=\"absolute ltr:right-0 rtl:left-0 top-0\" type=\"submit\">\n\t\t\t\t\t\t\t<Icon className=\"text-24\" color=\"action\">\n\t\t\t\t\t\t\t\tsend\n\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t</Paper>\n\t\t\t\t</form>\n\t\t\t)}\n\t\t</Paper>\n\t);\n}\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}