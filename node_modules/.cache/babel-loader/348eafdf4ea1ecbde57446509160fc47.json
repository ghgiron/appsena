{"ast":null,"code":"import FuseUtils from '@fuse/utils';\nimport _ from '@lodash';\nimport jwt from 'jsonwebtoken';\nimport mock from '../mock';\n/* eslint-disable camelcase */\n\nconst jwtConfig = {\n  secret: 'some-secret-code-goes-here',\n  expiresIn: '2 days' // A numeric value is interpreted as a seconds count. If you use a string be sure you provide the time units (days, hours, etc)\n\n};\nconst authDB = {\n  users: [{\n    uuid: '0123456789',\n    from: 'custom-db',\n    password: 'admin',\n    role: 'admin',\n    data: {\n      displayName: 'celso Mendoza',\n      photoURL: 'assets/images/avatars/user.jpg',\n      email: 'admin',\n      settings: {\n        layout: {\n          style: 'layout1',\n          config: {\n            scroll: 'content',\n            navbar: {\n              display: true,\n              folded: true,\n              position: 'left'\n            },\n            toolbar: {\n              display: true,\n              style: 'fixed',\n              position: 'below'\n            },\n            footer: {\n              display: false,\n              style: 'fixed',\n              position: 'below'\n            },\n            mode: 'fullwidth'\n          }\n        },\n        customScrollbars: true\n      },\n      shortcuts: ['applications', 'GestionGAES', 'crearempresa']\n    }\n  }, {\n    uuid: '0123456788',\n    from: 'custom-db',\n    password: 'admin',\n    role: 'admin',\n    data: {\n      displayName: 'celso Mendoza',\n      photoURL: 'assets/images/avatars/user.jpg',\n      email: 'admin',\n      settings: {\n        layout: {\n          style: 'layout1',\n          config: {\n            scroll: 'content',\n            navbar: {\n              display: true,\n              folded: true,\n              position: 'left'\n            },\n            toolbar: {\n              display: true,\n              style: 'fixed',\n              position: 'below'\n            },\n            footer: {\n              display: false,\n              style: 'fixed',\n              position: 'below'\n            },\n            mode: 'fullwidth'\n          }\n        },\n        customScrollbars: true\n      },\n      shortcuts: ['applications', 'GestionGAES', 'crearempresa']\n    }\n  }]\n};\nmock.onGet('/api/auth').reply(config => {\n  const data = JSON.parse(config.data);\n  const {\n    email,\n    password\n  } = data;\n\n  const user = _.cloneDeep(authDB.users.find(_user => _user.data.email === email));\n\n  const error = {\n    email: user ? null : 'Verifica tu usuario o email',\n    password: user && user.password === password ? null : 'Verifica tu contraseña'\n  };\n\n  if (!error.email && !error.password && !error.displayName) {\n    delete user.password;\n    const access_token = jwt.sign({\n      id: user.uuid\n    }, jwtConfig.secret, {\n      expiresIn: jwtConfig.expiresIn\n    });\n    const response = {\n      user,\n      access_token\n    };\n    return [200, response];\n  }\n\n  return [200, {\n    error\n  }];\n});\nmock.onGet('/api/auth/access-token').reply(config => {\n  const data = JSON.parse(config.data);\n  const {\n    access_token\n  } = data;\n\n  try {\n    const {\n      id\n    } = jwt.verify(access_token, jwtConfig.secret);\n\n    const user = _.cloneDeep(authDB.users.find(_user => _user.uuid === id));\n\n    delete user.password;\n    const updatedAccessToken = jwt.sign({\n      id: user.uuid\n    }, jwtConfig.secret, {\n      expiresIn: jwtConfig.expiresIn\n    });\n    const response = {\n      user,\n      access_token: updatedAccessToken\n    };\n    return [200, response];\n  } catch (e) {\n    const error = 'Token de acceso no válido detectado';\n    return [401, {\n      error\n    }];\n  }\n});\nmock.onPost('/api/auth/register').reply(request => {\n  const data = JSON.parse(request.data);\n  const {\n    displayName,\n    password,\n    email\n  } = data;\n  const isEmailExists = authDB.users.find(_user => _user.data.email === email);\n  const error = {\n    email: isEmailExists ? 'El correo electrónico ya está en uso' : null,\n    displayName: displayName !== '' ? null : 'Ingrese el nombre para mostrar',\n    password: null\n  };\n\n  if (!error.displayName && !error.password && !error.email) {\n    const newUser = {\n      uuid: FuseUtils.generateGUID(),\n      from: 'custom-db',\n      password,\n      role: 'admin',\n      data: {\n        displayName,\n        photoURL: 'assets/images/avatars/Abbott.jpg',\n        email,\n        settings: {},\n        shortcuts: []\n      }\n    };\n    authDB.users = [...authDB.users, newUser];\n\n    const user = _.cloneDeep(newUser);\n\n    delete user.password;\n    const access_token = jwt.sign({\n      id: user.uuid\n    }, jwtConfig.secret, {\n      expiresIn: jwtConfig.expiresIn\n    });\n    const response = {\n      user,\n      access_token\n    };\n    return [200, response];\n  }\n\n  return [200, {\n    error\n  }];\n});\nmock.onPost('/api/auth/user/update').reply(config => {\n  const data = JSON.parse(config.data);\n  const {\n    user\n  } = data;\n  authDB.users = authDB.users.map(_user => {\n    if (user.uuid === user.id) {\n      return _.merge(_user, user);\n    }\n\n    return _user;\n  });\n  return [200, user];\n});","map":{"version":3,"sources":["D:/proyectos_react/Proyecto_sena_desarrollo/src/@fake-db/db/auth-db.js"],"names":["FuseUtils","_","jwt","mock","jwtConfig","secret","expiresIn","authDB","users","uuid","from","password","role","data","displayName","photoURL","email","settings","layout","style","config","scroll","navbar","display","folded","position","toolbar","footer","mode","customScrollbars","shortcuts","onGet","reply","JSON","parse","user","cloneDeep","find","_user","error","access_token","sign","id","response","verify","updatedAccessToken","e","onPost","request","isEmailExists","newUser","generateGUID","map","merge"],"mappings":"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","sourcesContent":["import FuseUtils from '@fuse/utils';\nimport _ from '@lodash';\nimport jwt from 'jsonwebtoken';\nimport mock from '../mock';\n/* eslint-disable camelcase */\n\nconst jwtConfig = {\n\tsecret: 'some-secret-code-goes-here',\n\texpiresIn: '2 days' // A numeric value is interpreted as a seconds count. If you use a string be sure you provide the time units (days, hours, etc)\n};\n\nconst authDB = {\n\tusers: [\n\t\t{\n\t\t\tuuid: '0123456789',\n\t\t\tfrom: 'custom-db',\n\t\t\tpassword: 'admin',\n\t\t\trole: 'admin',\n\t\t\tdata: {\n\t\t\t\tdisplayName: 'celso Mendoza',\n\t\t\t\tphotoURL: 'assets/images/avatars/user.jpg',\n\t\t\t\temail: 'admin',\n\t\t\t\tsettings: {\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\tstyle: 'layout1',\n\t\t\t\t\t\tconfig: {\n\t\t\t\t\t\t\tscroll: 'content',\n\t\t\t\t\t\t\tnavbar: {\n\t\t\t\t\t\t\t\tdisplay: true,\n\t\t\t\t\t\t\t\tfolded: true,\n\t\t\t\t\t\t\t\tposition: 'left'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttoolbar: {\n\t\t\t\t\t\t\t\tdisplay: true,\n\t\t\t\t\t\t\t\tstyle: 'fixed',\n\t\t\t\t\t\t\t\tposition: 'below'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfooter: {\n\t\t\t\t\t\t\t\tdisplay: false,\n\t\t\t\t\t\t\t\tstyle: 'fixed',\n\t\t\t\t\t\t\t\tposition: 'below'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmode: 'fullwidth'\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcustomScrollbars: true,\n\t\t\t\t},\n\t\t\t\tshortcuts: ['applications', 'GestionGAES', 'crearempresa']\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tuuid: '0123456788',\n\t\t\tfrom: 'custom-db',\n\t\t\tpassword: 'admin',\n\t\t\trole: 'admin',\n\t\t\tdata: {\n\t\t\t\tdisplayName: 'celso Mendoza',\n\t\t\t\tphotoURL: 'assets/images/avatars/user.jpg',\n\t\t\t\temail: 'admin',\n\t\t\t\tsettings: {\n\t\t\t\t\tlayout: {\n\t\t\t\t\t\tstyle: 'layout1',\n\t\t\t\t\t\tconfig: {\n\t\t\t\t\t\t\tscroll: 'content',\n\t\t\t\t\t\t\tnavbar: {\n\t\t\t\t\t\t\t\tdisplay: true,\n\t\t\t\t\t\t\t\tfolded: true,\n\t\t\t\t\t\t\t\tposition: 'left'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttoolbar: {\n\t\t\t\t\t\t\t\tdisplay: true,\n\t\t\t\t\t\t\t\tstyle: 'fixed',\n\t\t\t\t\t\t\t\tposition: 'below'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfooter: {\n\t\t\t\t\t\t\t\tdisplay: false,\n\t\t\t\t\t\t\t\tstyle: 'fixed',\n\t\t\t\t\t\t\t\tposition: 'below'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmode: 'fullwidth'\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tcustomScrollbars: true,\n\t\t\t\t},\n\t\t\t\tshortcuts: ['applications', 'GestionGAES', 'crearempresa']\n\t\t\t}\n\t\t},\n\t]\n};\n\nmock.onGet('/api/auth').reply(config => {\n\tconst data = JSON.parse(config.data);\n\tconst { email, password } = data;\n\n\tconst user = _.cloneDeep(authDB.users.find(_user => _user.data.email === email));\n\n\tconst error = {\n\t\temail: user ? null : 'Verifica tu usuario o email',\n\t\tpassword: user && user.password === password ? null : 'Verifica tu contraseña'\n\t};\n\n\tif (!error.email && !error.password && !error.displayName) {\n\t\tdelete user.password;\n\n\t\tconst access_token = jwt.sign({ id: user.uuid }, jwtConfig.secret, { expiresIn: jwtConfig.expiresIn });\n\n\t\tconst response = {\n\t\t\tuser,\n\t\t\taccess_token\n\t\t};\n\n\t\treturn [200, response];\n\t}\n\treturn [200, { error }];\n});\n\nmock.onGet('/api/auth/access-token').reply(config => {\n\tconst data = JSON.parse(config.data);\n\tconst { access_token } = data;\n\n\ttry {\n\t\tconst { id } = jwt.verify(access_token, jwtConfig.secret);\n\n\t\tconst user = _.cloneDeep(authDB.users.find(_user => _user.uuid === id));\n\t\tdelete user.password;\n\n\t\tconst updatedAccessToken = jwt.sign({ id: user.uuid }, jwtConfig.secret, { expiresIn: jwtConfig.expiresIn });\n\n\t\tconst response = {\n\t\t\tuser,\n\t\t\taccess_token: updatedAccessToken\n\t\t};\n\n\t\treturn [200, response];\n\t} catch (e) {\n\t\tconst error = 'Token de acceso no válido detectado';\n\t\treturn [401, { error }];\n\t}\n});\n\nmock.onPost('/api/auth/register').reply(request => {\n\tconst data = JSON.parse(request.data);\n\tconst { displayName, password, email } = data;\n\tconst isEmailExists = authDB.users.find(_user => _user.data.email === email);\n\tconst error = {\n\t\temail: isEmailExists ? 'El correo electrónico ya está en uso' : null,\n\t\tdisplayName: displayName !== '' ? null : 'Ingrese el nombre para mostrar',\n\t\tpassword: null\n\t};\n\tif (!error.displayName && !error.password && !error.email) {\n\t\tconst newUser = {\n\t\t\tuuid: FuseUtils.generateGUID(),\n\t\t\tfrom: 'custom-db',\n\t\t\tpassword,\n\t\t\trole: 'admin',\n\t\t\tdata: {\n\t\t\t\tdisplayName,\n\t\t\t\tphotoURL: 'assets/images/avatars/Abbott.jpg',\n\t\t\t\temail,\n\t\t\t\tsettings: {},\n\t\t\t\tshortcuts: []\n\t\t\t}\n\t\t};\n\n\t\tauthDB.users = [...authDB.users, newUser];\n\n\t\tconst user = _.cloneDeep(newUser);\n\t\tdelete user.password;\n\n\t\tconst access_token = jwt.sign({ id: user.uuid }, jwtConfig.secret, { expiresIn: jwtConfig.expiresIn });\n\n\t\tconst response = {\n\t\t\tuser,\n\t\t\taccess_token\n\t\t};\n\n\t\treturn [200, response];\n\t}\n\treturn [200, { error }];\n});\n\nmock.onPost('/api/auth/user/update').reply(config => {\n\tconst data = JSON.parse(config.data);\n\tconst { user } = data;\n\n\tauthDB.users = authDB.users.map(_user => {\n\t\tif (user.uuid === user.id) {\n\t\t\treturn _.merge(_user, user);\n\t\t}\n\t\treturn _user;\n\t});\n\n\treturn [200, user];\n});\n"]},"metadata":{},"sourceType":"module"}