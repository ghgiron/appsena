{"ast":null,"code":"var _jsxFileName = \"D:\\\\proyectos_react\\\\Proyecto_sena\\\\src\\\\app\\\\main\\\\apps\\\\chat\\\\Chat.js\";\nimport FuseScrollbars from '@fuse/core/FuseScrollbars';\nimport Avatar from '@material-ui/core/Avatar';\nimport Icon from '@material-ui/core/Icon';\nimport IconButton from '@material-ui/core/IconButton';\nimport Paper from '@material-ui/core/Paper';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport clsx from 'clsx';\nimport moment from 'moment/moment';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { selectContacts } from './store/contactsSlice';\nimport { sendMessage } from './store/chatSlice';\nconst useStyles = makeStyles(theme => ({\n  messageRow: {\n    '&.contact': {\n      '& .bubble': {\n        backgroundColor: theme.palette.background.paper,\n        color: theme.palette.getContrastText(theme.palette.background.paper),\n        borderTopLeftRadius: 5,\n        borderBottomLeftRadius: 5,\n        borderTopRightRadius: 20,\n        borderBottomRightRadius: 20,\n        '& .time': {\n          marginLeft: 12\n        }\n      },\n      '&.first-of-group': {\n        '& .bubble': {\n          borderTopLeftRadius: 20\n        }\n      },\n      '&.last-of-group': {\n        '& .bubble': {\n          borderBottomLeftRadius: 20\n        }\n      }\n    },\n    '&.me': {\n      paddingLeft: 40,\n      '& .avatar': {\n        order: 2,\n        margin: '0 0 0 16px'\n      },\n      '& .bubble': {\n        marginLeft: 'auto',\n        backgroundColor: theme.palette.primary.main,\n        color: theme.palette.primary.contrastText,\n        borderTopLeftRadius: 20,\n        borderBottomLeftRadius: 20,\n        borderTopRightRadius: 5,\n        borderBottomRightRadius: 5,\n        '& .time': {\n          justifyContent: 'flex-end',\n          right: 0,\n          marginRight: 12\n        }\n      },\n      '&.first-of-group': {\n        '& .bubble': {\n          borderTopRightRadius: 20\n        }\n      },\n      '&.last-of-group': {\n        '& .bubble': {\n          borderBottomRightRadius: 20\n        }\n      }\n    },\n    '&.contact + .me, &.me + .contact': {\n      paddingTop: 20,\n      marginTop: 20\n    },\n    '&.first-of-group': {\n      '& .bubble': {\n        borderTopLeftRadius: 20,\n        paddingTop: 13\n      }\n    },\n    '&.last-of-group': {\n      '& .bubble': {\n        borderBottomLeftRadius: 20,\n        paddingBottom: 13,\n        '& .time': {\n          display: 'flex'\n        }\n      }\n    }\n  }\n}));\n\nfunction Chat(props) {\n  const dispatch = useDispatch();\n  const contacts = useSelector(selectContacts);\n  const selectedContactId = useSelector(({\n    chatApp\n  }) => chatApp.contacts.selectedContactId);\n  const chat = useSelector(({\n    chatApp\n  }) => chatApp.chat);\n  const user = useSelector(({\n    chatApp\n  }) => chatApp.user);\n  const classes = useStyles(props);\n  const chatRef = useRef(null);\n  const [messageText, setMessageText] = useState('');\n  useEffect(() => {\n    if (chat) {\n      scrollToBottom();\n    }\n  }, [chat]);\n\n  function scrollToBottom() {\n    chatRef.current.scrollTop = chatRef.current.scrollHeight;\n  }\n\n  function shouldShowContactAvatar(item, i) {\n    return item.who === selectedContactId && (chat.dialog[i + 1] && chat.dialog[i + 1].who !== selectedContactId || !chat.dialog[i + 1]);\n  }\n\n  function isFirstMessageOfGroup(item, i) {\n    return i === 0 || chat.dialog[i - 1] && chat.dialog[i - 1].who !== item.who;\n  }\n\n  function isLastMessageOfGroup(item, i) {\n    return i === chat.dialog.length - 1 || chat.dialog[i + 1] && chat.dialog[i + 1].who !== item.who;\n  }\n\n  function onInputChange(ev) {\n    setMessageText(ev.target.value);\n  }\n\n  function onMessageSubmit(ev) {\n    ev.preventDefault();\n\n    if (messageText === '') {\n      return;\n    }\n\n    dispatch(sendMessage({\n      messageText,\n      chatId: chat.id,\n      contactId: selectedContactId\n    })).then(() => {\n      setMessageText('');\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: clsx('flex flex-col relative', props.className),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(FuseScrollbars, {\n    ref: chatRef,\n    className: \"flex flex-1 flex-col overflow-y-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 4\n    }\n  }, chat && chat.dialog.length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col pt-16 px-16 ltr:pl-56 rtl:pr-56 pb-40\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 6\n    }\n  }, chat.dialog.map((item, i) => {\n    const contact = item.who === user.id ? user : contacts.find(_contact => _contact.id === item.who);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: item.time,\n      className: clsx(classes.messageRow, 'flex flex-col flex-grow-0 flex-shrink-0 items-start justify-end relative px-16 pb-4', {\n        me: item.who === user.id\n      }, {\n        contact: item.who !== user.id\n      }, {\n        'first-of-group': isFirstMessageOfGroup(item, i)\n      }, {\n        'last-of-group': isLastMessageOfGroup(item, i)\n      }, i + 1 === chat.dialog.length && 'pb-96'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 9\n      }\n    }, shouldShowContactAvatar(item, i) && /*#__PURE__*/React.createElement(Avatar, {\n      className: \"avatar absolute ltr:left-0 rtl:right-0 m-0 -mx-32\",\n      src: contact.avatar,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"bubble flex relative items-center justify-center p-12 max-w-full shadow-1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 10\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"leading-tight whitespace-pre-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }\n    }, item.message), /*#__PURE__*/React.createElement(Typography, {\n      className: \"time absolute hidden w-full text-11 mt-8 -mb-24 ltr:left-0 rtl:right-0 bottom-0 whitespace-no-wrap\",\n      color: \"textSecondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 11\n      }\n    }, moment(item.time).format('MMMM Do YYYY, h:mm:ss a'))));\n  })) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col flex-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-col flex-1 items-center justify-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    className: \"text-128\",\n    color: \"disabled\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 8\n    }\n  }, \"chat\")), /*#__PURE__*/React.createElement(Typography, {\n    className: \"px-16 pb-24 text-center\",\n    color: \"textSecondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }\n  }, \"Start a conversation by typing your message below.\"))), chat && /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: onMessageSubmit,\n    className: \"absolute bottom-0 right-0 left-0 py-16 px-8\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    className: \"flex items-center relative rounded-24\",\n    elevation: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    autoFocus: false,\n    id: \"message-input\",\n    className: \"flex-1\",\n    InputProps: {\n      disableUnderline: true,\n      classes: {\n        root: 'flex flex-grow flex-shrink-0 mx-16 ltr:mr-48 rtl:ml-48 my-8',\n        input: ''\n      },\n      placeholder: 'Type your message'\n    },\n    InputLabelProps: {\n      shrink: false,\n      className: classes.bootstrapFormLabel\n    },\n    onChange: onInputChange,\n    value: messageText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(IconButton, {\n    className: \"absolute ltr:right-0 rtl:left-0 top-0\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    className: \"text-24\",\n    color: \"action\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 8\n    }\n  }, \"send\")))));\n}\n\nexport default Chat;","map":{"version":3,"sources":["D:/proyectos_react/Proyecto_sena/src/app/main/apps/chat/Chat.js"],"names":["FuseScrollbars","Avatar","Icon","IconButton","Paper","makeStyles","TextField","Typography","clsx","moment","React","useEffect","useRef","useState","useDispatch","useSelector","selectContacts","sendMessage","useStyles","theme","messageRow","backgroundColor","palette","background","paper","color","getContrastText","borderTopLeftRadius","borderBottomLeftRadius","borderTopRightRadius","borderBottomRightRadius","marginLeft","paddingLeft","order","margin","primary","main","contrastText","justifyContent","right","marginRight","paddingTop","marginTop","paddingBottom","display","Chat","props","dispatch","contacts","selectedContactId","chatApp","chat","user","classes","chatRef","messageText","setMessageText","scrollToBottom","current","scrollTop","scrollHeight","shouldShowContactAvatar","item","i","who","dialog","isFirstMessageOfGroup","isLastMessageOfGroup","length","onInputChange","ev","target","value","onMessageSubmit","preventDefault","chatId","id","contactId","then","className","map","contact","find","_contact","time","me","avatar","message","format","disableUnderline","root","input","placeholder","shrink","bootstrapFormLabel"],"mappings":"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","sourcesContent":["import FuseScrollbars from '@fuse/core/FuseScrollbars';\nimport Avatar from '@material-ui/core/Avatar';\nimport Icon from '@material-ui/core/Icon';\nimport IconButton from '@material-ui/core/IconButton';\nimport Paper from '@material-ui/core/Paper';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport clsx from 'clsx';\nimport moment from 'moment/moment';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { selectContacts } from './store/contactsSlice';\nimport { sendMessage } from './store/chatSlice';\n\nconst useStyles = makeStyles(theme => ({\n\tmessageRow: {\n\t\t'&.contact': {\n\t\t\t'& .bubble': {\n\t\t\t\tbackgroundColor: theme.palette.background.paper,\n\t\t\t\tcolor: theme.palette.getContrastText(theme.palette.background.paper),\n\t\t\t\tborderTopLeftRadius: 5,\n\t\t\t\tborderBottomLeftRadius: 5,\n\t\t\t\tborderTopRightRadius: 20,\n\t\t\t\tborderBottomRightRadius: 20,\n\t\t\t\t'& .time': {\n\t\t\t\t\tmarginLeft: 12\n\t\t\t\t}\n\t\t\t},\n\t\t\t'&.first-of-group': {\n\t\t\t\t'& .bubble': {\n\t\t\t\t\tborderTopLeftRadius: 20\n\t\t\t\t}\n\t\t\t},\n\t\t\t'&.last-of-group': {\n\t\t\t\t'& .bubble': {\n\t\t\t\t\tborderBottomLeftRadius: 20\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t'&.me': {\n\t\t\tpaddingLeft: 40,\n\n\t\t\t'& .avatar': {\n\t\t\t\torder: 2,\n\t\t\t\tmargin: '0 0 0 16px'\n\t\t\t},\n\t\t\t'& .bubble': {\n\t\t\t\tmarginLeft: 'auto',\n\t\t\t\tbackgroundColor: theme.palette.primary.main,\n\t\t\t\tcolor: theme.palette.primary.contrastText,\n\t\t\t\tborderTopLeftRadius: 20,\n\t\t\t\tborderBottomLeftRadius: 20,\n\t\t\t\tborderTopRightRadius: 5,\n\t\t\t\tborderBottomRightRadius: 5,\n\t\t\t\t'& .time': {\n\t\t\t\t\tjustifyContent: 'flex-end',\n\t\t\t\t\tright: 0,\n\t\t\t\t\tmarginRight: 12\n\t\t\t\t}\n\t\t\t},\n\t\t\t'&.first-of-group': {\n\t\t\t\t'& .bubble': {\n\t\t\t\t\tborderTopRightRadius: 20\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'&.last-of-group': {\n\t\t\t\t'& .bubble': {\n\t\t\t\t\tborderBottomRightRadius: 20\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t'&.contact + .me, &.me + .contact': {\n\t\t\tpaddingTop: 20,\n\t\t\tmarginTop: 20\n\t\t},\n\t\t'&.first-of-group': {\n\t\t\t'& .bubble': {\n\t\t\t\tborderTopLeftRadius: 20,\n\t\t\t\tpaddingTop: 13\n\t\t\t}\n\t\t},\n\t\t'&.last-of-group': {\n\t\t\t'& .bubble': {\n\t\t\t\tborderBottomLeftRadius: 20,\n\t\t\t\tpaddingBottom: 13,\n\t\t\t\t'& .time': {\n\t\t\t\t\tdisplay: 'flex'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}));\n\nfunction Chat(props) {\n\tconst dispatch = useDispatch();\n\tconst contacts = useSelector(selectContacts);\n\tconst selectedContactId = useSelector(({ chatApp }) => chatApp.contacts.selectedContactId);\n\tconst chat = useSelector(({ chatApp }) => chatApp.chat);\n\tconst user = useSelector(({ chatApp }) => chatApp.user);\n\n\tconst classes = useStyles(props);\n\tconst chatRef = useRef(null);\n\tconst [messageText, setMessageText] = useState('');\n\n\tuseEffect(() => {\n\t\tif (chat) {\n\t\t\tscrollToBottom();\n\t\t}\n\t}, [chat]);\n\n\tfunction scrollToBottom() {\n\t\tchatRef.current.scrollTop = chatRef.current.scrollHeight;\n\t}\n\n\tfunction shouldShowContactAvatar(item, i) {\n\t\treturn (\n\t\t\titem.who === selectedContactId &&\n\t\t\t((chat.dialog[i + 1] && chat.dialog[i + 1].who !== selectedContactId) || !chat.dialog[i + 1])\n\t\t);\n\t}\n\n\tfunction isFirstMessageOfGroup(item, i) {\n\t\treturn i === 0 || (chat.dialog[i - 1] && chat.dialog[i - 1].who !== item.who);\n\t}\n\n\tfunction isLastMessageOfGroup(item, i) {\n\t\treturn i === chat.dialog.length - 1 || (chat.dialog[i + 1] && chat.dialog[i + 1].who !== item.who);\n\t}\n\n\tfunction onInputChange(ev) {\n\t\tsetMessageText(ev.target.value);\n\t}\n\n\tfunction onMessageSubmit(ev) {\n\t\tev.preventDefault();\n\t\tif (messageText === '') {\n\t\t\treturn;\n\t\t}\n\n\t\tdispatch(\n\t\t\tsendMessage({\n\t\t\t\tmessageText,\n\t\t\t\tchatId: chat.id,\n\t\t\t\tcontactId: selectedContactId\n\t\t\t})\n\t\t).then(() => {\n\t\t\tsetMessageText('');\n\t\t});\n\t}\n\n\treturn (\n\t\t<div className={clsx('flex flex-col relative', props.className)}>\n\t\t\t<FuseScrollbars ref={chatRef} className=\"flex flex-1 flex-col overflow-y-auto\">\n\t\t\t\t{chat && chat.dialog.length > 0 ? (\n\t\t\t\t\t<div className=\"flex flex-col pt-16 px-16 ltr:pl-56 rtl:pr-56 pb-40\">\n\t\t\t\t\t\t{chat.dialog.map((item, i) => {\n\t\t\t\t\t\t\tconst contact =\n\t\t\t\t\t\t\t\titem.who === user.id ? user : contacts.find(_contact => _contact.id === item.who);\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={item.time}\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\tclasses.messageRow,\n\t\t\t\t\t\t\t\t\t\t'flex flex-col flex-grow-0 flex-shrink-0 items-start justify-end relative px-16 pb-4',\n\t\t\t\t\t\t\t\t\t\t{ me: item.who === user.id },\n\t\t\t\t\t\t\t\t\t\t{ contact: item.who !== user.id },\n\t\t\t\t\t\t\t\t\t\t{ 'first-of-group': isFirstMessageOfGroup(item, i) },\n\t\t\t\t\t\t\t\t\t\t{ 'last-of-group': isLastMessageOfGroup(item, i) },\n\t\t\t\t\t\t\t\t\t\ti + 1 === chat.dialog.length && 'pb-96'\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{shouldShowContactAvatar(item, i) && (\n\t\t\t\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"avatar absolute ltr:left-0 rtl:right-0 m-0 -mx-32\"\n\t\t\t\t\t\t\t\t\t\t\tsrc={contact.avatar}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t<div className=\"bubble flex relative items-center justify-center p-12 max-w-full shadow-1\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"leading-tight whitespace-pre-wrap\">{item.message}</div>\n\t\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"time absolute hidden w-full text-11 mt-8 -mb-24 ltr:left-0 rtl:right-0 bottom-0 whitespace-no-wrap\"\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"textSecondary\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{moment(item.time).format('MMMM Do YYYY, h:mm:ss a')}\n\t\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"flex flex-col flex-1\">\n\t\t\t\t\t\t<div className=\"flex flex-col flex-1 items-center justify-center\">\n\t\t\t\t\t\t\t<Icon className=\"text-128\" color=\"disabled\">\n\t\t\t\t\t\t\t\tchat\n\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Typography className=\"px-16 pb-24 text-center\" color=\"textSecondary\">\n\t\t\t\t\t\t\tStart a conversation by typing your message below.\n\t\t\t\t\t\t</Typography>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</FuseScrollbars>\n\t\t\t{chat && (\n\t\t\t\t<form onSubmit={onMessageSubmit} className=\"absolute bottom-0 right-0 left-0 py-16 px-8\">\n\t\t\t\t\t<Paper className=\"flex items-center relative rounded-24\" elevation={1}>\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tautoFocus={false}\n\t\t\t\t\t\t\tid=\"message-input\"\n\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\tdisableUnderline: true,\n\t\t\t\t\t\t\t\tclasses: {\n\t\t\t\t\t\t\t\t\troot: 'flex flex-grow flex-shrink-0 mx-16 ltr:mr-48 rtl:ml-48 my-8',\n\t\t\t\t\t\t\t\t\tinput: ''\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tplaceholder: 'Type your message'\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tInputLabelProps={{\n\t\t\t\t\t\t\t\tshrink: false,\n\t\t\t\t\t\t\t\tclassName: classes.bootstrapFormLabel\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonChange={onInputChange}\n\t\t\t\t\t\t\tvalue={messageText}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<IconButton className=\"absolute ltr:right-0 rtl:left-0 top-0\" type=\"submit\">\n\t\t\t\t\t\t\t<Icon className=\"text-24\" color=\"action\">\n\t\t\t\t\t\t\t\tsend\n\t\t\t\t\t\t\t</Icon>\n\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t</Paper>\n\t\t\t\t</form>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}